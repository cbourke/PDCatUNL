<!doctype html>
<html lang="en" class="h-100" data-bs-theme="auto">
  <head>
    <!--<script src="./assets/js/color-modes.js"></script>-->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.111.3">
    <title>Parallel &amp; Distributed Computing at the University of Nebraska-Lincoln</title>

<link href="./assets/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .b-example-divider {
        width: 100%;
        height: 3rem;
        background-color: rgba(0, 0, 0, .1);
        border: solid rgba(0, 0, 0, .15);
        border-width: 1px 0;
        box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
      }

      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }

      .bi {
        vertical-align: -.125em;
        fill: currentColor;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }

      .btn-bd-primary {
        --bd-violet-bg: #712cf9;
        --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

        --bs-btn-font-weight: 600;
        --bs-btn-color: var(--bs-white);
        --bs-btn-bg: var(--bd-violet-bg);
        --bs-btn-border-color: var(--bd-violet-bg);
        --bs-btn-hover-color: var(--bs-white);
        --bs-btn-hover-bg: #6528e0;
        --bs-btn-hover-border-color: #6528e0;
        --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
        --bs-btn-active-color: var(--bs-btn-hover-color);
        --bs-btn-active-bg: #5a23c8;
        --bs-btn-active-border-color: #5a23c8;
      }
      .bd-mode-toggle {
        z-index: 1500;
      }
    </style>


    <!-- Custom styles for this template -->
    <link href="sticky-footer-navbar.css" rel="stylesheet">
  </head>
  <body class="d-flex flex-column h-100">
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="check2" viewBox="0 0 16 16">
        <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
      </symbol>
      <symbol id="circle-half" viewBox="0 0 16 16">
        <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
      </symbol>
      <symbol id="moon-stars-fill" viewBox="0 0 16 16">
        <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
      </symbol>
      <symbol id="sun-fill" viewBox="0 0 16 16">
        <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
      </symbol>
    </svg>

    <div class="dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle">
      <button class="btn btn-bd-primary py-2 dropdown-toggle d-flex align-items-center"
              id="bd-theme"
              type="button"
              aria-expanded="false"
              data-bs-toggle="dropdown"
              aria-label="Toggle theme (auto)">
        <svg class="bi my-1 theme-icon-active" width="1em" height="1em"><use href="#circle-half"></use></svg>
        <span class="visually-hidden" id="bd-theme-text">Toggle theme</span>
      </button>
      <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="bd-theme-text">
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
            <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#sun-fill"></use></svg>
            Light
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
            <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#moon-stars-fill"></use></svg>
            Dark
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
            <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#circle-half"></use></svg>
            Auto
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
      </ul>
    </div>


    <header>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="./index.html">PDC@UNL</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav me-auto mb-2 mb-md-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="./index.html">Home</a>
              </li>

              <!--
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" aria-expanded="false">Module 1.0</a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="./module01.html">Overview</a></li>
                  <div class="dropdown-divider"></div>
                  <li><a class="dropdown-item" href="./module01-01.html">Asynch Demo 1</a></li>
                  <li><a class="dropdown-item" href="./module01-02.html">Asynch Demo 2</a></li>
                  <li><a class="dropdown-item" href="./module01-03.html">Parallel Demo</a></li>
                </ul>
              </li>
            -->

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" aria-expanded="false">Parallel Computing</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="./module-parallel.html">Overview</a></li>
                <div class="dropdown-divider"></div>
                <li><a class="dropdown-item" href="./module-parallel-visual.html">Visualization Demo</a></li>
                <li><a class="dropdown-item" href="./module-parallel-demo.html">Code Demo</a></li>
                <li><a class="dropdown-item" href="./module-parallel-tutorial.html">Code Tutorial</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="./module-parallel.html" data-bs-toggle="dropdown" aria-expanded="false">Asynchronous Computing</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="./module-asynch.html">Overview</a></li>
                <div class="dropdown-divider"></div>
                <!-- TODO: Design a sequence graph visualization demo
                <li><a class="dropdown-item" href="./module-asynch-visual.html">Demo</a></li>
                -->
                <li><a class="dropdown-item" href="./module-asynch-demo.html">Demo</a></li>
                <!--
                <li><a class="dropdown-item" href="./module-asynch-demo.html">Code Demo</a></li>
                <li><a class="dropdown-item" href="./module-asynch-tutorial.html">Code Tutorial</a></li>
                -->
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="./module-dist.html" data-bs-toggle="dropdown" aria-expanded="false">Distributed Computing</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="./module-dist.html">Overview</a></li>
                <div class="dropdown-divider"></div>
                <li><a class="dropdown-item" href="./module-dist-visual.html">Visualization Demo</a></li>
                <li><a class="dropdown-item" href="./module-dist-demo.html">Code Demo</a></li>
                <!--
                <li><a class="dropdown-item" href="./module-asynch-tutorial.html">Code Tutorial</a></li>
                -->
              </ul>
            </li>

            </ul>
          </div>
        </div>
      </nav>
    </header>


<!-- Begin page content -->


<main class="flex-shrink-0">
  <div class="container">

    <div class="p-5 mb-4 bg-body-tertiary rounded-3">
          <div class="container-fluid py-5">
            <h1 class="display-5 fw-bold">PDC@UNL</h1>
            <p class="col-md-8 fs-4">Parallel Computing - Code Tutorial</p>
            <p>In this activity, we will walk you through writing code to use OpenMP to
              parallelize your program.</p>
          </div>
        </div>
    <div class="container col-9">

      <h1 id="">Parallelizing Code</h1>

      <p>Writing parallel code can be challenging.  The traditional methods would
        require you to define <i>threads</i> which are part of a program that
        can be run concurrently while sharing some resources (memory) but that
        are still part of one program or process.  A multithreaded program needs
        to be written to manage its threads and ensure that they all execute
        correctly as well as managing shared resources to ensure threads do not
        interfere with each other.  If you are interested in what this looks
        like in C, view the source code for the <code>crackParallel.c</code>
        program you built and ran.</p>

      <p>Fortunately, we can utilize a library to do most of this work for us.
        <a href="https://www.openmp.org/">OpenMP</a> is an open-source standard
        that is utilized in many programming languages to make writing multithreaded
        programs easier.  To get exposure to how ridiculously easy this is, we'll
        walk you through and example.  Consider again the <code>crackSequential</code>
        program that you built and ran to break passwords.  We'll modify this
        program using OpenMP so that it can be run in parallel.</p>

      <h2>Instructions</h2>
      <ol>
        <li>Open the <code>crackParallel-openmp.c</code> in an editor and briefly
          compare it to the <code>crackSequential.c</code>.  We recommend you use 
          the <code>pico</code> editor.  From the command line use:<br/><br/>  

		  <code>pico crackParallel-open.c</code><br/><br/>  
		  
		  This will open a TUI (Text User Interface) editor.  You can start 
		  typing/deleting.  When you are done, exit the editor using <code>control-X</code> 
		  and it will prompt you if you want to save or not; type <code>Y</code> to save.<br/><br/>  
          
          Some code to support the number of threads as a command line argument 
          has already been provided for you.</li>
        <li>Include the OpenMP library by adding the following include statement.<br/>
          <code>#include &lt;omp.h&gt;</code></li>
        <li>After the dictionary has been loaded (the call to the <code>initDictionary()</code>),
          add the following line.  This will setup OpenMP to use the specified
          number of threads.<br/>
          <code>omp_set_num_threads(numThreads);</code></li>
        <li>Now for the magic.  Add the following line above the <code>for</code>
          loop:<br/>
          <code>#pragma omp parallel for private(password,j,hash),shared(hashedPassword,m,DICTIONARY),schedule(guided, 2000)</code></br>
          Let's understand what this is doing:
          <ul>
            <li><code>#pragma</code> is a "pragmatic" that tells the compiler
              to use features of the OpenMP library.  It essentially adds the
              necessary code to make your loop parallel.</li>
            <li><code>private(password,j,hash)</code> tells OpenMP which variables
              should be <i>not</i> be shared between threads and instead makes
              distinct copies for each thread.  For example, the <code>password</code>
              and <code>j</code> are variables that are updated <i>inside</i>
              the for loop and are unique to each thread.  It wouldn't work
              if the same value of <code>j</code> were used by all threads.</li>
            <li><code>shared(hashedPassword,m,DICTIONARY)</code> specifies variables
              that <i>are</i> shared among each thread.  None of these variables are
              changed inside the loop and so the same value can be used by all
              threads.  By default, variables are considered <code>shared</code>
              unless you specify them <code>private</code> so this isn't strictly
              necessary, but for illustrative purposes, we identified all variables
              explicitly (and it is best practice).</li>
            <li><code>schedule(guided, 2000)</code> tells OpenMP how to split
              up the work.  The outer <code>for</code> loop will execute 247,406
              times, once for each word in the dictionary.  This line splits it
              up so that each thread will process (at least) 2,000 words.  This is known as
              a <i>chunk</i> of work.  The <code>guided</code> is a strategy by
              which chunks are divided among threads (but we won't get into specifics
              on this).</li>
          </ul>
        </li>
        <li>Now when your program runs, OpenMP will split the work of testing
          247,406 dictionary words among the specified number of threads.
          For example, if you specify 8 threads, each one will be responsible
          for checking about about <code>247,406 / 8 = 30,925</code> words.  You
          can expect your program to run <i>about</i> 8 times as fast!</li>
        <li>Let's actually run your program now.  Build this OpenMP program by
          running the following command:<br/>
          <code>make crackOpenMP</code></br>
          which produces an executable called <code>crackOpenMP</code></li>
        <li>Run your program similar to how you ran the other version:<br/>
          <code>time ./crackOpenMP "0x618e0fcd87c82dea5cbc48b6ca32415951c79d21fc17a9a2e8a6170994b0cb0b" 8</code></li>
      </ol>
      <p>Congratulations on <b>writing</b> your first multithreaded program!</p>



      <div style="min-height: 200px;">&nbsp;</div>

    </div>
  </div>
</main>

<footer class="footer mt-auto py-3 bg-body-tertiary">
  <div class="container">
    <span class="text-body-secondary">PDC@UNL - Parallel &amp; Distributed Computing at the University of Nebraska-Lincoln</span>
  </div>
</footer>


    <script src="./assets/dist/js/bootstrap.bundle.min.js"></script>


  </body>
</html>
